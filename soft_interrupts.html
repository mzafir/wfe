<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Soft Interrupts Graph</title>
    <style> /* set the CSS */
    .line {
        fill: none;
        stroke: steelblue;
        stroke-width: 2px;
    }
    .line-chart
    {
        border: 1px solid lightgray;
    }
    </style>
</head>
<body>
<h3>Soft Interrupts</h3>
<svg></svg>
<!-- load the d3.js library -->
<script src="https://d3js.org/d3.v4.min.js"></script>
<script>

    // Get the data
    d3.json("day0.json", function(error, data) {
        if (error) throw error;
        // trigger render
        draw(data);
    });

    function draw(data) {
        let array = [];
        for(let i=0; i<data.length; i++){
            let item = data[i];
            let object = {
                interrupt: item['soft_interrupts'],
                sample: i//item['sample']
            };
            array.push(object);
        }
        console.log(array);

        const svgWidth = 600, svgHeight = 400;
        const margin = {top: 20, right: 20, bottom: 30, left: 50};
        const width = svgWidth - margin.left - margin.right;
        const height = svgHeight - margin.top - margin.bottom;
        const svg = d3.select('svg')
            .attr("width", svgWidth)
            .attr("height", svgHeight);

        const g = svg.append("g").attr("transform",
                "translate(" + margin.left + "," + margin.top + ")"
            );
        const x = d3.scaleLinear().rangeRound([0, width]);
        const y = d3.scaleLinear().rangeRound([height, 0]);

        let line = d3.line()
            .x(function(d) { return x(d.sample)})
            .y(function(d) { return y(d.interrupt)});
        x.domain(d3.extent(array, function(d) { return d.sample }));
        y.domain(d3.extent(array, function(d) { return d.interrupt }));

        g.append("g")
            .attr("transform", "translate(0," + height + ")")
            .call(d3.axisBottom(x))
            .select(".domain")
            .remove();

        g.append("g")
            .call(d3.axisLeft(y))
            .append("text")
            .attr("fill", "#000")
            .attr("transform", "rotate(-90)")
            .attr("y", 6)
            .attr("dy", "0.71em")
            .attr("text-anchor", "end")
            .text("Interrupt");

        g.append("path")
            .datum(array)
            .attr("fill", "none")
            .attr("stroke", "steelblue")
            .attr("stroke-linejoin", "round")
            .attr("stroke-linecap", "round")
            .attr("stroke-width", 1.5)
            .attr("d", line);
    }

</script>
</body>
</html>